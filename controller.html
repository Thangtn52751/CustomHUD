<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Bảng điều khiển HUD BLAST – Upload Logo</title>
<style>
body { font-family: Arial; padding: 20px; background: #101014; color: #fff; }
button { padding: 10px 20px; font-size: 18px; margin: 6px; cursor: pointer; border-radius: 8px; }
input[type="text"], input[type="file"] { padding: 8px; font-size: 16px; margin: 6px; width: 250px; }
.team-block { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #333; }
</style>
</head>
<body>
<h1>BẢNG ĐIỀU KHIỂN HUD BLAST PREMIER</h1>

<div class="team-block">
<h2>TEAM 1</h2>
<input id="t1-name" type="text" placeholder="Tên đội 1"><button onclick="setName(1)">Đặt tên</button><br>
<input id="t1-logo" type="text" placeholder="URL logo đội 1"><button onclick="setLogo(1)">Đặt logo</button><br>
<input type="file" id="t1-logo-file"><button onclick="uploadLogo(1)">Upload logo</button><br>
<button onclick="addScore(1)">+ Điểm</button>
<button onclick="subScore(1)">- Điểm</button>
</div>

<div class="team-block">
<h2>TEAM 2</h2>
<input id="t2-name" type="text" placeholder="Tên đội 2"><button onclick="setName(2)">Đặt tên</button><br>
<input id="t2-logo" type="text" placeholder="URL logo đội 2"><button onclick="setLogo(2)">Đặt logo</button><br>
<input type="file" id="t2-logo-file"><button onclick="uploadLogo(2)">Upload logo</button><br>
<button onclick="addScore(2)">+ Điểm</button>
<button onclick="subScore(2)">- Điểm</button>
</div>

<button onclick="resetScore()" style="background:red;color:white;">RESET SCORE</button>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDyaRt2wZFse86lHpqMm5oS96xNLoGUZOY",
  authDomain: "demo1-36441.firebaseapp.com",
  databaseURL: "https://demo1-36441-default-rtdb.firebaseio.com",
  projectId: "demo1-36441",
  storageBucket: "demo1-36441.firebasestorage.app",
  messagingSenderId: "80993200631",
  appId: "1:80993200631:web:f7bd3b0eeecb52c5b1e6f2",
  measurementId: "G-VBB23MLC0J"
};
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Thay token & repo của bạn
const GITHUB_TOKEN = "YOUR_PERSONAL_ACCESS_TOKEN";
const REPO = "Thangtn52751/CustomHUD";

function setName(team){
  let name = document.getElementById(`t${team}-name`).value;
  db.ref(`teams/team${team}/name`).set(name);
}

function setLogo(team){
  let url = document.getElementById(`t${team}-logo`).value;
  db.ref(`teams/team${team}/logo`).set(url);
}

// Upload file logo lên GitHub và lấy raw link
async function uploadLogo(team){
  const fileInput = document.getElementById(`t${team}-logo-file`);
  if(fileInput.files.length===0){ alert("Chọn file logo!"); return; }
  const file = fileInput.files[0];
  const reader = new FileReader();
  reader.onload = async function(e){
    const base64 = e.target.result.split(",")[1];
    const path = `logos/team${team}-${Date.now()}.png`;
    const response = await fetch(`https://api.github.com/repos/${REPO}/contents/${path}`,{
      method: "PUT",
      headers: {
        "Authorization": `token ${GITHUB_TOKEN}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        message: `Upload logo team ${team}`,
        content: base64
      })
    });
    const data = await response.json();
    const rawUrl = `https://raw.githubusercontent.com/${REPO}/main/${path}`;
    db.ref(`teams/team${team}/logo`).set(rawUrl);
    alert("Upload thành công, HUD sẽ cập nhật logo ngay!");
  };
  reader.readAsDataURL(file);
}

// Điểm số
function addScore(team){ db.ref(`teams/team${team}/score`).transaction(x=>(x||0)+1); }
function subScore(team){ db.ref(`teams/team${team}/score`).transaction(x=>(x||0)-1); }
function resetScore(){ db.ref("teams").set({ team1:{score:0,name:"TEAM A",logo:""}, team2:{score:0,name:"TEAM B",logo:""} }); }

</script>
</body>
</html>
